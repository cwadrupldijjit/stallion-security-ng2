System.register([], function(exports_1) {
    var SlimScroll;
    return {
        setters:[],
        execute: function() {
            SlimScroll = function (C, payload) {
                var i = {}, w = "wrapper", s = "scrollBar", S = "scrollBarContainer", a = "", m = "", l = "data-slimscroll", 
                // properties
                oT = "offsetTop", sT = "scrollTop", pE = "parentElement", pes = "previousElementSibling", iH = "innerHTML", cT = "currentTarget", sK = "scroll-k", U = "%", d = ".", 
                // IE8 properties 
                // (Dev note: remove below variables from all over the code to exclude IE8 compatibility)
                pN = "parentNode", pS = "previousSibling", sE = "srcElement", assignValues = function (k) {
                    var q = i.E;
                    i.h = i[S].offsetHeight;
                    i.sH = i[w].scrollHeight;
                    i.sP = (i.h / i.sH) * 100;
                    // i.sbh is scroll bar height in pixels without pixel unit.
                    i.sbh = i.sP * i.h / 100;
                    // Manually set the height of the scrollbar (in percentage)
                    // if user hasn't provided the fixed scroll height value
                    if (!q.sH)
                        i.sP1 = i.sbh < q.mH ? (q.mH / i.h * 100) : i.sP;
                    else
                        i.sP1 = q.sH / i.h * 100;
                    i.rP1 = 100 - i.sP1;
                    i.x = (i.sH - i.h) * ((i.sP1 - i.sP) / (100 - i.sP));
                    i.sH1 = Math.abs((i.x / (i.rP1)) + (i.sH / 100));
                    i[s].style.height = i.sP1 + U;
                    i.reposition = getReposition(i[s], i.h);
                }, 
                // Start of private functions
                setAttr = function (e, p, v) {
                    e.setAttribute(p, v);
                }, getAttr = function (e, p) {
                    if (!e)
                        return;
                    return e.getAttribute(p);
                }, addClass = function (e, c) {
                    if (c.length)
                        e.className = c;
                }, cE = function (c, h, p) {
                    var d = document.createElement('div');
                    addClass(d, c);
                    d[iH] = h;
                    p.appendChild(d);
                    return d;
                }, setScroll = function (e) {
                    var e = e || event, el = e.target || event[sE], p = el[pE] || el[pN];
                    var q = i.E;
                    if (!i || p === i[S])
                        return;
                    var eY = e.pageY || event.clientY, top = ((eY - getTop(i[w][pE] || i[w][pN])) / i.h * 100) - i.sP1 / 2;
                    if (top > i.rP1)
                        top = i.rP1;
                    else if (top < 0)
                        top = 0;
                    i[s].style.top = top + U;
                    i[w][sT] = top * i.sH1;
                    addClass(i[S], q.S + q.a);
                }, beginScroll = function (e) {
                    // removing selected text
                    // Link: http://stackoverflow.com/a/3171348
                    var sel = window.getSelection ? window.getSelection() : document.selection;
                    if (sel) {
                        if (sel.removeAllRanges)
                            sel.removeAllRanges();
                        else if (sel.empty)
                            sel.empty();
                    }
                    var e = e || event, el = e[cT] || e[sE];
                    addEvent('mousemove', document, moveScroll);
                    addEvent('mouseup', document, endScroll);
                    i[oT] = getTop(i[w]);
                    i.firstY = e.pageY || event.clientY;
                    if (!i.reposition)
                        i.reposition = getReposition(i[s], i.h);
                    // Disable text selection while dragging the scrollbar
                    return false;
                }, getReposition = function (i, h) {
                    var x = parseInt(i.style.top.replace(U, ""), 10) * h / 100;
                    return x ? x : 0;
                }, moveScroll = function (e) {
                    var e = e || event, q = i.E, eY = e.pageY || e.clientY, top = (i.reposition + eY - i.firstY) / i.h * 100;
                    if (i.rP1 < top)
                        top = i.rP1;
                    if (!i.previousTop)
                        i.previousTop = top + 1;
                    var blnThreshold = top >= 0 && i.firstY > i[oT];
                    if ((i.previousTop > top && blnThreshold) || (blnThreshold && (i[w][sT] + i.h !== i.sH))) {
                        i[s].style.top = top + U;
                        i.previousTop = top;
                        i[w][sT] = top * i.sH1;
                    }
                    addClass(i[S], q.S);
                }, endScroll = function (e) {
                    var e = e || event, q = i.E;
                    removeEvent('mousemove', document);
                    removeEvent('mouseup', document);
                    i.reposition = 0;
                    addClass(i[S], q.S + q.a);
                }, doScroll = function (e) {
                    var e = e || event;
                    if (!i)
                        return;
                    var q = i.E;
                    addClass(i[S], q.S);
                    i[s].style.top = i[w][sT] / i.sH1 + U;
                    addClass(i[S], q.S + q.a);
                }, addEvent = function (e, el, func) {
                    el['on' + e] = func;
                    // el.addEventListener(e, func, false);
                }, removeEvent = function (e, el) {
                    el['on' + e] = null;
                    // el.removeEventListener(e, func, false);
                }, addCSSRule = function (S, s, r, i) {
                    if (S.insertRule)
                        S.insertRule(s + "{" + r + "}", i);
                    else if (S.addRule)
                        S.addRule(s, r, i);
                }, getTop = function (el) {
                    var t = document.documentElement[sT];
                    return el.getBoundingClientRect().top + (t ? t : document.body[sT]);
                }, insertCss = function () {
                    if (SlimScroll.inserted) {
                        return;
                    }
                    // Inserting css rules
                    // Link: http://davidwalsh.name/add-rules-stylesheets
                    var slim = "[" + l + "]", imp = " !important", pA = "position:absolute" + imp, 
                    // classes
                    w = pA + ";overflow:auto" + imp + ";left:0px;top:0px" + imp + ";right:-18px;bottom:0px" + imp + ";padding-right:8px" + imp + ";", S = pA + ";top:0px" + imp + ";bottom:0px" + imp + ";right:0px;left:auto;width:5px;cursor:pointer" + imp + ";padding-right:0px" + imp + ";", s = pA + ";background-color:#999;top:0px;left:0px;right:0px;", 
                    //creating a sheet
                    style = document.createElement('style'), scrollBar = "[data-scrollbar]";
                    try {
                        // WebKit hack :(
                        style.appendChild(document.createTextNode(""));
                    }
                    catch (ex) { }
                    var head = document.head || document.getElementsByTagName('head')[0];
                    // adding above css to the sheet
                    head.insertBefore(style, (head.hasChildNodes())
                        ? head.childNodes[0]
                        : null);
                    var sheet = style.sheet;
                    if (sheet) {
                        addCSSRule(sheet, slim + ">div", w, 0);
                        addCSSRule(sheet, slim + ">div+div", S, 0);
                        addCSSRule(sheet, scrollBar, s, 0);
                    }
                    else {
                        style.styleSheet.cssText = slim + ">div{" + w + "}" + slim + ">div+div" + "{" + S + "}" + slim + ">div+div>div{" + s + "}";
                    }
                    window.slimScroll.inserted = true;
                }, 
                // Initial function
                init = function () {
                    C.removeAttribute(l); //reset
                    if (C.offsetHeight < C.scrollHeight) {
                        setAttr(C, l, '1');
                        insertCss();
                        var h = C[iH], q = i.E = {};
                        // setting user defined classes
                        payload = payload || {};
                        q.w = payload.wrapperClass || "";
                        q.s = payload.scrollBarClass || "";
                        q.S = payload.scrollBarContainerClass || "";
                        q.a = payload.scrollBarContainerSpecialClass ? " " + payload.scrollBarContainerSpecialClass : "";
                        q.mH = payload.scrollBarMinHeight || 25;
                        q.sH = payload.scrollBarFixedHeight; // could be undefined
                        C[iH] = "";
                        i[w] = cE(q.w, h, C);
                        i[S] = cE(q.S + q.a, "", C);
                        i[s] = cE(q.s, "", i[S]);
                        setAttr(i[s], 'data-scrollbar', '1');
                        assignValues();
                        if (payload.keepFocus) {
                            setAttr(i[w], 'tabindex', '-1');
                            i[w].focus();
                        }
                        // Attaching mouse events
                        addEvent('mousedown', i[s], beginScroll);
                        addEvent('click', i[S], setScroll);
                        // For scroll
                        addEvent('scroll', i[w], doScroll);
                    }
                }();
                return {
                    resetValues: assignValues
                };
            };
            exports_1("SlimScroll", SlimScroll);
        }
    }
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9zbGltc2Nyb2xsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7UUFtQkksVUFBVTs7OztZQUFWLFVBQVUsR0FBRyxVQUFTLENBQWMsRUFBRSxPQUFPO2dCQUM3QyxJQUFJLENBQUMsR0FBTSxFQUFFLEVBQ1QsQ0FBQyxHQUFHLFNBQVMsRUFBQyxDQUFDLEdBQUcsV0FBVyxFQUFDLENBQUMsR0FBRyxvQkFBb0IsRUFBQyxDQUFDLEdBQUcsRUFBRSxFQUFDLENBQUMsR0FBRyxFQUFFLEVBQUMsQ0FBQyxHQUFDLGlCQUFpQjtnQkFDeEYsYUFBYTtnQkFDYixFQUFFLEdBQUcsV0FBVyxFQUFDLEVBQUUsR0FBRyxXQUFXLEVBQUMsRUFBRSxHQUFHLGVBQWUsRUFBQyxHQUFHLEdBQUUsd0JBQXdCLEVBQ3BGLEVBQUUsR0FBRyxXQUFXLEVBQUMsRUFBRSxHQUFHLGVBQWUsRUFBQyxFQUFFLEdBQUcsVUFBVSxFQUFDLENBQUMsR0FBRyxHQUFHLEVBQUMsQ0FBQyxHQUFHLEdBQUc7Z0JBQ3JFLGtCQUFrQjtnQkFDbEIseUZBQXlGO2dCQUN6RixFQUFFLEdBQUcsWUFBWSxFQUFDLEVBQUUsR0FBRyxpQkFBaUIsRUFBQyxFQUFFLEdBQUcsWUFBWSxFQUMxRCxZQUFZLEdBQUcsVUFBUyxDQUFDO29CQUNyQixJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO29CQUNaLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFlBQVksQ0FBQztvQkFDeEIsQ0FBQyxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsWUFBWSxDQUFDO29CQUN6QixDQUFDLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEdBQUcsR0FBRyxDQUFDO29CQUN4QiwyREFBMkQ7b0JBQzNELENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFDLEdBQUcsQ0FBQztvQkFDdkIsMkRBQTJEO29CQUMzRCx3REFBd0Q7b0JBQ3hELEVBQUUsQ0FBQSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQzt3QkFBQyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxDQUFDLEVBQUUsR0FBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLEdBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUMsR0FBRSxDQUFDLENBQUMsRUFBRSxDQUFDO29CQUN2RCxJQUFJO3dCQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxDQUFDLEVBQUUsR0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQztvQkFFNUIsQ0FBQyxDQUFDLEdBQUcsR0FBRyxHQUFHLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQztvQkFDcEIsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxFQUFFLENBQUMsR0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztvQkFDbkQsQ0FBQyxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsR0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO29CQUMvQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQztvQkFFOUIsQ0FBQyxDQUFDLFVBQVUsR0FBRyxhQUFhLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDNUMsQ0FB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QUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQzt3QkFDakIsQ0FBQzt3QkFDRCx5QkFBeUI7d0JBQ3pCLFFBQVEsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLFdBQVcsQ0FBQyxDQUFDO3dCQUN6QyxRQUFRLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxTQUFTLENBQUMsQ0FBQzt3QkFDbkMsYUFBYTt3QkFDYixRQUFRLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxRQUFRLENBQUMsQ0FBQztvQkFFdkMsQ0FBQztnQkFDTCxDQUFDLEVBQUUsQ0FBQztnQkFDUixNQUFNLENBQUM7b0JBQ0gsV0FBVyxFQUFFLFlBQVk7aUJBQzVCLENBQUE7WUFDTCxDQUFDLENBQUM7WUFFTyxtQ0FBVSIsImZpbGUiOiJhcHAvc2xpbXNjcm9sbC5qcyIsInNvdXJjZXNDb250ZW50IjpbImludGVyZmFjZSBJIHtcblx0RT87XG5cdGg/O1xuXHRzSD87XG5cdHNIMT87XG5cdHNQPztcblx0c1AxPztcblx0c2JoPztcblx0clAxPztcblx0eD87XG5cdHJlcG9zaXRpb24/O1xuXHRmaXJzdFk/O1xuXHRwcmV2aW91c1RvcD87XG59XG5cbmludGVyZmFjZSBRIHtcblx0XG59XG5cbnZhciBTbGltU2Nyb2xsID0gZnVuY3Rpb24oQzogSFRNTEVsZW1lbnQsIHBheWxvYWQpe1xuICAgIHZhciBpOiBJID0ge30sXG4gICAgICAgIHcgPSBcIndyYXBwZXJcIixzID0gXCJzY3JvbGxCYXJcIixTID0gXCJzY3JvbGxCYXJDb250YWluZXJcIixhID0gXCJcIixtID0gXCJcIixsPVwiZGF0YS1zbGltc2Nyb2xsXCIsXG4gICAgICAgIC8vIHByb3BlcnRpZXNcbiAgICAgICAgb1QgPSBcIm9mZnNldFRvcFwiLHNUID0gXCJzY3JvbGxUb3BcIixwRSA9IFwicGFyZW50RWxlbWVudFwiLHBlcz0gXCJwcmV2aW91c0VsZW1lbnRTaWJsaW5nXCIsIFxuICAgICAgICBpSCA9IFwiaW5uZXJIVE1MXCIsY1QgPSBcImN1cnJlbnRUYXJnZXRcIixzSyA9IFwic2Nyb2xsLWtcIixVID0gXCIlXCIsZCA9IFwiLlwiLFxuICAgICAgICAvLyBJRTggcHJvcGVydGllcyBcbiAgICAgICAgLy8gKERldiBub3RlOiByZW1vdmUgYmVsb3cgdmFyaWFibGVzIGZyb20gYWxsIG92ZXIgdGhlIGNvZGUgdG8gZXhjbHVkZSBJRTggY29tcGF0aWJpbGl0eSlcbiAgICAgICAgcE4gPSBcInBhcmVudE5vZGVcIixwUyA9IFwicHJldmlvdXNTaWJsaW5nXCIsc0UgPSBcInNyY0VsZW1lbnRcIixcbiAgICAgICAgYXNzaWduVmFsdWVzID0gZnVuY3Rpb24oayl7XG4gICAgICAgICAgICB2YXIgcSA9IGkuRTtcbiAgICAgICAgICAgIGkuaCA9IGlbU10ub2Zmc2V0SGVpZ2h0O1xuICAgICAgICAgICAgaS5zSCA9IGlbd10uc2Nyb2xsSGVpZ2h0O1xuICAgICAgICAgICAgaS5zUCA9IChpLmgvaS5zSCkgKiAxMDA7XG4gICAgICAgICAgICAvLyBpLnNiaCBpcyBzY3JvbGwgYmFyIGhlaWdodCBpbiBwaXhlbHMgd2l0aG91dCBwaXhlbCB1bml0LlxuICAgICAgICAgICAgaS5zYmggPSBpLnNQICogaS5oLzEwMDtcbiAgICAgICAgICAgIC8vIE1hbnVhbGx5IHNldCB0aGUgaGVpZ2h0IG9mIHRoZSBzY3JvbGxiYXIgKGluIHBlcmNlbnRhZ2UpXG4gICAgICAgICAgICAvLyBpZiB1c2VyIGhhc24ndCBwcm92aWRlZCB0aGUgZml4ZWQgc2Nyb2xsIGhlaWdodCB2YWx1ZVxuICAgICAgICAgICAgaWYoIXEuc0gpIGkuc1AxID0gaS5zYmggPCBxLm1IPyAocS5tSC9pLmggKiAxMDApOiBpLnNQO1xuICAgICAgICAgICAgZWxzZSBpLnNQMSA9IHEuc0gvaS5oICogMTAwO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpLnJQMSA9IDEwMCAtIGkuc1AxO1xuICAgICAgICAgICAgaS54ID0gKGkuc0ggLSBpLmgpICogKChpLnNQMSAtIGkuc1ApLygxMDAgLSBpLnNQKSk7XG4gICAgICAgICAgICBpLnNIMSA9IE1hdGguYWJzKChpLnggLyAoaS5yUDEpKSArIChpLnNILzEwMCkpO1xuICAgICAgICAgICAgaVtzXS5zdHlsZS5oZWlnaHQgPSBpLnNQMSArIFU7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGkucmVwb3NpdGlvbiA9IGdldFJlcG9zaXRpb24oaVtzXSwgaS5oKTtcbiAgICAgICAgfSxcbiAgICAgICAgLy8gU3RhcnQgb2YgcHJpdmF0ZSBmdW5jdGlvbnNcbiAgICAgICAgc2V0QXR0ciA9IGZ1bmN0aW9uKGUsIHAsIHYpe1xuICAgICAgICAgICAgZS5zZXRBdHRyaWJ1dGUocCx2KTtcbiAgICAgICAgfSxcbiAgICAgICAgZ2V0QXR0ciA9IGZ1bmN0aW9uKGUsIHApe1xuICAgICAgICAgICAgaWYoIWUpIHJldHVybjtcbiAgICAgICAgICAgIHJldHVybiBlLmdldEF0dHJpYnV0ZShwKTsgICAgICAgICAgICBcbiAgICAgICAgfSxcbiAgICAgICAgYWRkQ2xhc3MgPSBmdW5jdGlvbihlLCBjKXtcbiAgICAgICAgICAgIGlmKGMubGVuZ3RoKSBlLmNsYXNzTmFtZSA9IGM7XG4gICAgICAgIH0sXG4gICAgICAgIGNFID0gZnVuY3Rpb24oYywgaCwgcCl7XG4gICAgICAgICAgICB2YXIgZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgYWRkQ2xhc3MoZCwgYyk7XG4gICAgICAgICAgICBkW2lIXSA9IGg7XG4gICAgICAgICAgICBwLmFwcGVuZENoaWxkKGQpO1xuICAgICAgICAgICAgcmV0dXJuIGQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldFNjcm9sbCA9IGZ1bmN0aW9uKGUpe1xuICAgICAgICAgICAgdmFyIGUgPSBlIHx8IGV2ZW50LGVsID0gZS50YXJnZXQgfHwgZXZlbnRbc0VdLFxuICAgICAgICAgICAgICAgIHAgPSBlbFtwRV0gfHwgZWxbcE5dO1xuICAgICAgICAgICAgdmFyIHEgPSBpLkU7XG5cbiAgICAgICAgICAgIGlmKCFpIHx8IHAgPT09IGlbU10pIHJldHVybjtcbiAgICAgICAgICAgIHZhciBlWSA9IGUucGFnZVkgfHwgZXZlbnQuY2xpZW50WSxcbiAgICAgICAgICAgICAgICB0b3AgPSAoKGVZIC0gZ2V0VG9wKGlbd11bcEVdIHx8IGlbd11bcE5dKSkvaS5oICogMTAwKSAtIGkuc1AxLzI7XG4gICAgICAgICAgICBpZih0b3AgPiBpLnJQMSkgdG9wID0gaS5yUDE7XG4gICAgICAgICAgICBlbHNlIGlmKHRvcCA8IDApIHRvcCA9IDA7XG4gICAgICAgICAgICBpW3NdLnN0eWxlLnRvcCA9IHRvcCArIFU7XG4gICAgICAgICAgICBpW3ddW3NUXSA9IHRvcCAqIGkuc0gxO1xuICAgICAgICAgICAgYWRkQ2xhc3MoaVtTXSwgcS5TICsgcS5hKTtcbiAgICAgICAgfSxcbiAgICAgICAgYmVnaW5TY3JvbGwgPSBmdW5jdGlvbihlKXtcbiAgICAgICAgICAgIC8vIHJlbW92aW5nIHNlbGVjdGVkIHRleHRcbiAgICAgICAgICAgIC8vIExpbms6IGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzMxNzEzNDhcbiAgICAgICAgICAgIHZhciBzZWwgPSB3aW5kb3cuZ2V0U2VsZWN0aW9uID8gd2luZG93LmdldFNlbGVjdGlvbigpIDogZG9jdW1lbnQuc2VsZWN0aW9uO1xuICAgICAgICAgICAgaWYgKHNlbCkge1xuICAgICAgICAgICAgICAgIGlmIChzZWwucmVtb3ZlQWxsUmFuZ2VzKSBzZWwucmVtb3ZlQWxsUmFuZ2VzKCk7XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoc2VsLmVtcHR5KSBzZWwuZW1wdHkoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBlID0gZSB8fCBldmVudCxcbiAgICAgICAgICAgICAgICBlbCA9IGVbY1RdIHx8IGVbc0VdO1xuXG4gICAgICAgICAgICBhZGRFdmVudCgnbW91c2Vtb3ZlJywgZG9jdW1lbnQsIG1vdmVTY3JvbGwpO1xuICAgICAgICAgICAgYWRkRXZlbnQoJ21vdXNldXAnLCBkb2N1bWVudCwgZW5kU2Nyb2xsKTtcblxuICAgICAgICAgICAgaVtvVF0gPSBnZXRUb3AoaVt3XSk7XG4gICAgICAgICAgICBpLmZpcnN0WSA9IGUucGFnZVkgfHwgZXZlbnQuY2xpZW50WTtcbiAgICAgICAgICAgIGlmKCFpLnJlcG9zaXRpb24pIGkucmVwb3NpdGlvbiA9IGdldFJlcG9zaXRpb24oaVtzXSwgaS5oKTtcbiAgICAgICAgICAgIC8vIERpc2FibGUgdGV4dCBzZWxlY3Rpb24gd2hpbGUgZHJhZ2dpbmcgdGhlIHNjcm9sbGJhclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICBnZXRSZXBvc2l0aW9uID0gZnVuY3Rpb24oaSwgaCl7XG4gICAgICAgICAgICB2YXIgeCA9IHBhcnNlSW50KGkuc3R5bGUudG9wLnJlcGxhY2UoVSxcIlwiKSwxMCkgKiBoLzEwMDtcbiAgICAgICAgICAgIHJldHVybiB4P3g6MDtcbiAgICAgICAgfSxcbiAgICAgICAgbW92ZVNjcm9sbCA9IGZ1bmN0aW9uKGUpe1xuICAgICAgICAgICAgdmFyIGUgPSBlIHx8IGV2ZW50LFxuICAgICAgICAgICAgICAgIHEgPSBpLkUsXG4gICAgICAgICAgICAgICAgZVkgPSBlLnBhZ2VZIHx8IGUuY2xpZW50WSxcbiAgICAgICAgICAgICAgICB0b3AgPSAoaS5yZXBvc2l0aW9uICsgZVkgLSBpLmZpcnN0WSkvaS5oICogMTAwO1xuXG4gICAgICAgICAgICBpZihpLnJQMSA8IHRvcCkgdG9wID0gaS5yUDE7XG4gICAgICAgICAgICBpZighaS5wcmV2aW91c1RvcCkgaS5wcmV2aW91c1RvcCA9IHRvcCArIDE7XG4gICAgICAgICAgICB2YXIgYmxuVGhyZXNob2xkID0gdG9wID49IDAgJiYgaS5maXJzdFkgPiBpW29UXTtcbiAgICAgICAgICAgIGlmKChpLnByZXZpb3VzVG9wID4gdG9wICYmIGJsblRocmVzaG9sZCkgfHwgKGJsblRocmVzaG9sZCAmJiAoaVt3XVtzVF0gKyBpLmggIT09IGkuc0gpKSl7XG4gICAgICAgICAgICAgICAgaVtzXS5zdHlsZS50b3AgPSB0b3AgKyBVO1xuICAgICAgICAgICAgICAgIGkucHJldmlvdXNUb3AgPSB0b3A7ICAgXG4gICAgICAgICAgICAgICAgaVt3XVtzVF0gPSB0b3AgKiBpLnNIMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFkZENsYXNzKGlbU10sIHEuUyk7XG4gICAgICAgIH0sXG4gICAgICAgIGVuZFNjcm9sbCA9IGZ1bmN0aW9uKGUpe1xuICAgICAgICAgICAgdmFyIGUgPSBlIHx8IGV2ZW50LHEgPSBpLkU7IFxuXG4gICAgICAgICAgICByZW1vdmVFdmVudCgnbW91c2Vtb3ZlJywgZG9jdW1lbnQpO1xuICAgICAgICAgICAgcmVtb3ZlRXZlbnQoJ21vdXNldXAnLCBkb2N1bWVudCk7XG5cbiAgICAgICAgICAgIGkucmVwb3NpdGlvbiA9IDA7XG4gICAgICAgICAgICBhZGRDbGFzcyhpW1NdLCBxLlMgKyBxLmEpO1xuICAgICAgICB9LFxuICAgICAgICBkb1Njcm9sbCA9IGZ1bmN0aW9uKGUpe1xuICAgICAgICAgICAgdmFyIGUgPSBlIHx8IGV2ZW50O1xuICAgICAgICAgICAgaWYoIWkpIHJldHVybjtcbiAgICAgICAgICAgIHZhciBxID0gaS5FO1xuICAgICAgICAgICAgYWRkQ2xhc3MoaVtTXSwgcS5TKTtcbiAgICAgICAgICAgIGlbc10uc3R5bGUudG9wID0gaVt3XVtzVF0vaS5zSDEgKyBVO1xuICAgICAgICAgICAgYWRkQ2xhc3MoaVtTXSwgcS5TICsgcS5hKTtcbiAgICAgICAgfSxcbiAgICAgICAgYWRkRXZlbnQgPSBmdW5jdGlvbihlLCBlbCwgZnVuYyl7XG4gICAgICAgICAgICBlbFsnb24nICsgZV0gPSBmdW5jO1xuICAgICAgICAgICAgLy8gZWwuYWRkRXZlbnRMaXN0ZW5lcihlLCBmdW5jLCBmYWxzZSk7XG4gICAgICAgIH0sXG4gICAgICAgIHJlbW92ZUV2ZW50ID0gZnVuY3Rpb24oZSwgZWwpe1xuICAgICAgICAgICAgZWxbJ29uJyArIGVdID0gbnVsbDtcbiAgICAgICAgICAgIC8vIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoZSwgZnVuYywgZmFsc2UpO1xuICAgICAgICB9LFxuICAgICAgICBhZGRDU1NSdWxlID0gZnVuY3Rpb24oUywgcywgciwgaSkge1xuICAgICAgICAgICAgaWYoUy5pbnNlcnRSdWxlKSBTLmluc2VydFJ1bGUocyArIFwie1wiICsgciArIFwifVwiLCBpKTtcbiAgICAgICAgICAgIGVsc2UgaWYoUy5hZGRSdWxlKSBTLmFkZFJ1bGUocywgciwgaSk7XG4gICAgICAgIH0sXG4gICAgICAgIGdldFRvcCA9IGZ1bmN0aW9uKGVsKXtcbiAgICAgICAgICAgIHZhciB0ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50W3NUXTtcbiAgICAgICAgICAgIHJldHVybiBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgKyAodD90OmRvY3VtZW50LmJvZHlbc1RdKTtcbiAgICAgICAgfSxcbiAgICAgICAgaW5zZXJ0Q3NzID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGlmKFNsaW1TY3JvbGwuaW5zZXJ0ZWQpe1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIEluc2VydGluZyBjc3MgcnVsZXNcbiAgICAgICAgICAgIC8vIExpbms6IGh0dHA6Ly9kYXZpZHdhbHNoLm5hbWUvYWRkLXJ1bGVzLXN0eWxlc2hlZXRzXG4gICAgICAgICAgICB2YXIgc2xpbSA9IFwiW1wiK2wrXCJdXCIsXG4gICAgICAgICAgICAgICAgaW1wID0gXCIgIWltcG9ydGFudFwiLFxuICAgICAgICAgICAgICAgIHBBID0gXCJwb3NpdGlvbjphYnNvbHV0ZVwiK2ltcCxcbiAgICAgICAgICAgICAgICAvLyBjbGFzc2VzXG4gICAgICAgICAgICAgICAgdyA9IHBBK1wiO292ZXJmbG93OmF1dG9cIitpbXArXCI7bGVmdDowcHg7dG9wOjBweFwiK2ltcCtcIjtyaWdodDotMThweDtib3R0b206MHB4XCIraW1wK1wiO3BhZGRpbmctcmlnaHQ6OHB4XCIraW1wK1wiO1wiLFxuICAgICAgICAgICAgICAgIFMgPSBwQStcIjt0b3A6MHB4XCIraW1wK1wiO2JvdHRvbTowcHhcIitpbXArXCI7cmlnaHQ6MHB4O2xlZnQ6YXV0bzt3aWR0aDo1cHg7Y3Vyc29yOnBvaW50ZXJcIitpbXArXCI7cGFkZGluZy1yaWdodDowcHhcIitpbXArXCI7XCIsXG4gICAgICAgICAgICAgICAgcyA9IHBBK1wiO2JhY2tncm91bmQtY29sb3I6Izk5OTt0b3A6MHB4O2xlZnQ6MHB4O3JpZ2h0OjBweDtcIixcbiAgICAgICAgICAgICAgICAvL2NyZWF0aW5nIGEgc2hlZXRcbiAgICAgICAgICAgICAgICBzdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyksXG4gICAgICAgICAgICAgICAgc2Nyb2xsQmFyID0gXCJbZGF0YS1zY3JvbGxiYXJdXCI7XG4gICAgICAgICAgICB0cnl7XG4gICAgICAgICAgICAgICAgLy8gV2ViS2l0IGhhY2sgOihcbiAgICAgICAgICAgICAgICBzdHlsZS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShcIlwiKSk7XG4gICAgICAgICAgICB9Y2F0Y2goZXgpe31cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIGhlYWQgPSAgZG9jdW1lbnQuaGVhZCB8fCBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaGVhZCcpWzBdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gYWRkaW5nIGFib3ZlIGNzcyB0byB0aGUgc2hlZXRcbiAgICAgICAgICAgIGhlYWQuaW5zZXJ0QmVmb3JlKHN0eWxlLCAoaGVhZC5oYXNDaGlsZE5vZGVzKCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gaGVhZC5jaGlsZE5vZGVzWzBdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogbnVsbCk7XG4gICAgICAgICAgICB2YXIgc2hlZXQgPSBzdHlsZS5zaGVldDtcbiAgICAgICAgICAgIGlmKHNoZWV0KXsgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgYWRkQ1NTUnVsZShzaGVldCwgc2xpbStcIj5kaXZcIiwgdywgMCk7XG4gICAgICAgICAgICAgICAgYWRkQ1NTUnVsZShzaGVldCwgc2xpbStcIj5kaXYrZGl2XCIsIFMsIDApO1xuICAgICAgICAgICAgICAgIGFkZENTU1J1bGUoc2hlZXQsIHNjcm9sbEJhciwgcywgMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgIHN0eWxlLnN0eWxlU2hlZXQuY3NzVGV4dCA9IHNsaW0rXCI+ZGl2e1wiK3crXCJ9XCIrc2xpbStcIj5kaXYrZGl2XCIrXCJ7XCIrUytcIn1cIitzbGltK1wiPmRpditkaXY+ZGl2e1wiK3MrXCJ9XCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB3aW5kb3cuc2xpbVNjcm9sbC5pbnNlcnRlZCA9IHRydWU7XG4gICAgICAgIH0sXG4gICAgICAgIC8vIEluaXRpYWwgZnVuY3Rpb25cbiAgICAgICAgaW5pdCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBDLnJlbW92ZUF0dHJpYnV0ZShsKTsgIC8vcmVzZXRcbiAgICAgICAgICAgIGlmKEMub2Zmc2V0SGVpZ2h0IDwgQy5zY3JvbGxIZWlnaHQpe1xuICAgICAgICAgICAgICAgIHNldEF0dHIoQywgbCwgJzEnKTtcbiAgICAgICAgICAgICAgICBpbnNlcnRDc3MoKTtcbiAgICAgICAgICAgICAgICB2YXIgaCA9IENbaUhdLCBxID0gaS5FID0ge307XG4gICAgICAgICAgICAgICAgLy8gc2V0dGluZyB1c2VyIGRlZmluZWQgY2xhc3Nlc1xuICAgICAgICAgICAgICAgIHBheWxvYWQgPSBwYXlsb2FkIHx8IHt9O1xuICAgICAgICAgICAgICAgIHEudyA9IHBheWxvYWQud3JhcHBlckNsYXNzIHx8IFwiXCI7XG4gICAgICAgICAgICAgICAgcS5zID0gcGF5bG9hZC5zY3JvbGxCYXJDbGFzcyB8fCBcIlwiO1xuICAgICAgICAgICAgICAgIHEuUyA9IHBheWxvYWQuc2Nyb2xsQmFyQ29udGFpbmVyQ2xhc3MgfHwgXCJcIjtcbiAgICAgICAgICAgICAgICBxLmEgPSBwYXlsb2FkLnNjcm9sbEJhckNvbnRhaW5lclNwZWNpYWxDbGFzcyA/IFwiIFwiICsgcGF5bG9hZC5zY3JvbGxCYXJDb250YWluZXJTcGVjaWFsQ2xhc3MgOiBcIlwiO1xuICAgICAgICAgICAgICAgIHEubUggPSBwYXlsb2FkLnNjcm9sbEJhck1pbkhlaWdodCB8fCAyNTtcbiAgICAgICAgICAgICAgICBxLnNIID0gcGF5bG9hZC5zY3JvbGxCYXJGaXhlZEhlaWdodDsgIC8vIGNvdWxkIGJlIHVuZGVmaW5lZFxuXG4gICAgICAgICAgICAgICAgQ1tpSF0gPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlbd10gPSBjRShxLncsIGgsIEMpO1xuICAgICAgICAgICAgICAgIGlbU10gPSBjRShxLlMgKyBxLmEsIFwiXCIsIEMpO1xuICAgICAgICAgICAgICAgIGlbc10gPSBjRShxLnMsIFwiXCIsIGlbU10pO1xuICAgICAgICAgICAgICAgIHNldEF0dHIoaVtzXSwgJ2RhdGEtc2Nyb2xsYmFyJywgJzEnKTtcbiAgICAgICAgICAgICAgICBhc3NpZ25WYWx1ZXMoKTtcblxuICAgICAgICAgICAgICAgIGlmKHBheWxvYWQua2VlcEZvY3VzKXtcbiAgICAgICAgICAgICAgICAgICAgc2V0QXR0cihpW3ddLCAndGFiaW5kZXgnLCAnLTEnKTtcbiAgICAgICAgICAgICAgICAgICAgaVt3XS5mb2N1cygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBBdHRhY2hpbmcgbW91c2UgZXZlbnRzXG4gICAgICAgICAgICAgICAgYWRkRXZlbnQoJ21vdXNlZG93bicsIGlbc10sIGJlZ2luU2Nyb2xsKTtcbiAgICAgICAgICAgICAgICBhZGRFdmVudCgnY2xpY2snLCBpW1NdLCBzZXRTY3JvbGwpO1xuICAgICAgICAgICAgICAgIC8vIEZvciBzY3JvbGxcbiAgICAgICAgICAgICAgICBhZGRFdmVudCgnc2Nyb2xsJywgaVt3XSwgZG9TY3JvbGwpO1xuICAgICAgICAgICAgICAgIC8vIGFkZEV2ZW50KCdzZWxlY3RzdGFydCcsIGlbU10sIGZ1bmN0aW9uKCl7cmV0dXJuO30pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KCk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzZXRWYWx1ZXM6IGFzc2lnblZhbHVlc1xuICAgIH1cbn07XG5cbmV4cG9ydCB7IFNsaW1TY3JvbGwgfTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
